pluginManagement {
    // Flutter SDK 경로를 하드코딩 (한글 경로 문제 우회)
    def flutterSdkPath = "C:\\flutter"
    
    println "=== Flutter SDK Path (hardcoded): $flutterSdkPath ==="
    
    // local.properties 강제 업데이트
    def localPropertiesFile = file("local.properties")
    def properties = new Properties()
    
    // Android SDK 경로 읽기
    def androidSdkPath = "C:\\AndroidSDK\\sdk"  // 기본값
    if (localPropertiesFile.exists()) {
        try {
            localPropertiesFile.withInputStream { 
                properties.load(it) 
            }
            def sdkDir = properties.getProperty("sdk.dir")
            if (sdkDir != null) {
                androidSdkPath = sdkDir
            }
        } catch (Exception e) {
            println "Warning: Could not read local.properties"
        }
    }
    
    // local.properties 다시 쓰기 (한글 없는 경로로)
    properties.setProperty("sdk.dir", androidSdkPath)
    properties.setProperty("flutter.sdk", flutterSdkPath)
    properties.setProperty("flutter.buildMode", "release")
    properties.setProperty("flutter.versionName", "1.0.0")
    properties.setProperty("flutter.versionCode", "1")
    
    try {
        localPropertiesFile.withWriter('UTF-8') { writer ->
            properties.store(writer, "Flutter configuration - Auto-generated")
        }
    } catch (Exception e) {
        println "Warning: Could not write local.properties: ${e.message}"
    }
    
    includeBuild("$flutterSdkPath/packages/flutter_tools/gradle")

    repositories {
        google()
        mavenCentral()
        gradlePluginPortal()
    }
}

plugins {
    id "dev.flutter.flutter-plugin-loader" version "1.0.0"
    id "com.android.application" version "8.1.4" apply false
    id "org.jetbrains.kotlin.android" version "2.1.0" apply false
}

include ":app"